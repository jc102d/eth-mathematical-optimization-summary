\documentclass[main]{subfiles}
\begin{document}

%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
% Main Topics: unimodular and totally unimodular matrices
% Total Unimodularity - 13.11.2017
% author: Vanessa Leite

\section{Total Unimodular Matrices}

\paragraph{Definition - Polyhedron integral} Let $P \subseteq \mathbb{R}^{n}$
be a polyhedron. P is integral if every "minimal wrt inclusion" face of $P$
contains integer points.

$P$ is a polyhedron and also a polytope. $P$ polytope $\rightarrow$ $P = 
conv(v^{1}, \dots, v^{t})$.\\
P is integral if the minimal faces (vertices) are integers, i.e, $v^{i} \in 
\mathbb{Z}^{n}$

\subparagraph{Fact from linear algebra - Cramer's rule}
$A \in \mathbb{Q}^{n \times n}$, regular, $b \in \mathbb{Q}^{n}$. $Ax = b 
\iff x = A^{-1}b \iff$ $\forall i = 1, \dots, n$, $x_{i} = \frac{det(A^{i})}
{det(A)}$, where $A^{i} = A^i_{\cdot l}$ $\forall l \in \{1, \dots, n \} 
\setminus \{i\}$, $A^{i}_{\cdot i} = b$, i.e, $A^i$ is the matrix formed by
replacing the $i$-th column of A by the column vector $b$.

\paragraph{Definition - unimodular}
$A \in \mathbb{Z}^{m \times n}$ of full row rank is unimodular if the
determinant of every basis of $A$ ($m \times n$ regular submatrix) is equal to
$\pm 1$. A matrix $A \in \Z^{m \times m}$ of full row rank is unimodular if $det(A) = \pm 1$.

\paragraph{Definition - totally unimodular}
$A \in \mathbb{Z}^{m \times n}$ is called totally unimodular (TU) if every
square submatrix of $A$ has determinant $0$, $+1$, or $-1$.

\paragraph{Examples:}
\begin{itemize}
\item
$\begin{bmatrix}
3 & 5\\
1 & 2 \\
\end{bmatrix}$ is unimodular but not totally unimodular
\item $A$ is TU $\rightarrow A \in \{-1, 0, +1\}^{m \times n}$
\item $A \in \{0, 1\}^{2 \times w}$ is always TU: 
$\begin{bmatrix}
0 & 1 & 0 & 1 & \dots \\
1 & 1 & 0 & 0 & \dots \\
\end{bmatrix}$
\item $A \in \{-1, 0, 1\}^{2 \times n}$ is TU $\leftrightarrow$ it does not
contain the submatrix 
$\begin{bmatrix}
\pm 1 & \pm 1 \\
\pm 1 & -1  \\
\end{bmatrix}$
\item $A \in \{0,1\}^{3 \times n}$ is not always TU, for instance, determinant
of 
$\begin{bmatrix}
1 & 1 & 0 \\
1 & 0 & 1 \\
0 & 1 & 1 \\
\end{bmatrix}$ is 2.
\end{itemize}

\paragraph{Propositions}
\begin{enumerate}
\item $A$ is TU $\leftrightarrow [AI]$ is unimodular
\item $A$ is TU $\leftrightarrow$
$\begin{bmatrix}
A \\
-A \\
I \\
-I \\
\end{bmatrix}$ is TU
\item $A$ is TU $\leftrightarrow A^{T}$ is TU
\end{enumerate}

\subparagraph{Proofs:}
\begin{enumerate}
\item \todo[inline]{add proof}
\item \todo[inline]{add proof}
\item if $A$ is TU, then every square submatrix of $A$ has determinant $0, \pm
1$. Since $det(A) = det(A^T)$, every square submatrix of $A^T$ has also
determinant $0, \pm 1$.
\end{enumerate}

\paragraph{Theorem - Unimodular}
Let $A \in \mathbb{Z}^{m \times n}$ of full row rank. $A$ is unimodular if and
only if the family of polyhedra $P(b) = \{ x \in \mathbb{R}^{n}_+ \mid Ax = b
\}$ is integral $\forall b \in \mathbb{Z}^{m}$ such that $P(b) \neq \emptyset$.

\subparagraph{Proof}
\begin{itemize}
\item direction "$\rightarrow$", Assume $A$ is unimodular $\rightarrow$ let $b
\in \mathbb{Z}^{m}$, $P(b) \neq \emptyset$. Take an extreme point $x^{*} \in
P(b)$. $x^{*} = (x^{*}_{B}, x^{*}_{N})$ for basis B, $x^{*}_{B} = A^{-1}_{B}b$,
$x^{*}_{N} = 0$.\\
$det[A_{B}] = \pm 1$ (because A is unimodular). From Cramer's rule $A_{B} \dot
x^{*}_{B} = b$, $x^{*}_{B}$ is integral. Hence, $x$ has integer entries.
Therefore, all extreme points of $P(b)$ are integral, i.e., $P(b)$ is integral.

\item direction "$\leftarrow$", Assume $x^{*}$ is integral. Suppose $P(b)$ is
integral, $\forall b \in \mathbb{Z}^{m}$ such that $P(b) \neq \emptyset$. Let
$B \subseteq \{1, \dots, n\}$ be a basis. We want to show $det(A_{B}) \in \{-1,
+1\}$.
Let $b = A_{B}z + \underbrace{e_{i}}_{\text{$i$-th unit vector}}$, where $z$ is
integer ($z \in \mathbb{Z}^{m}$) such that $z + A^{-1}_{B} e_{i} \geq 0$.
Consider $P(b)$ and the extreme point $(x^{*}_{B}, x^{*}_{N})$, $x^{*}_{B} =
A^{-1}_{B}b = z + A^{-1}_{B} e_{i}$ which by assumption is feasible for $P(b)$
by $z + A^{-1}_{B} e_{i} \geq 0$. $z + A^{-1}_{B} e_{i} \in \mathbb{Z}^{m}
\rightarrow A^{-1}_{B} e_{i} \in \mathbb{Z}^{m} \rightarrow A^{-1}_{B}$ is
integral $\rightarrow det(A_{B}) \in \{-1, +1\}$.
\end{itemize}

\paragraph{Theorem - Totally Unimodular}
Let $A \in \mathbb{Z}^{m \times n}$. $A$ is TU if and only if the family of
polyhedra $P(b) = \{ x \in \mathbb{R}^{n}_+ \mid Ax \leq b \}$ is integral
$\forall b \in \mathbb{Z}^{m}$ such that $P(b) \neq \emptyset$.

\subparagraph{Proof}
We know $A$ is TU $\iff [A,I]$ unimodular.\\
$P(b) = \{x \in \mathbb{R}^{n} \mid Ax \leq b \}$. Extreme points of $P(b)$ are
in 1-1-correspondence with extreme points in $\{(x,y) \mid Ax + Iy = b, y \geq
0 \}$. From previous proof result, this result follows.

\paragraph{Theorem - combination property} $A \in \mathbb{Z}^{m \times n}$ is
TU $\leftrightarrow$ for every subset $J$ of $\{1, \dots, n\}$ we can partition
$J$ into $J_{1}$ and $J_{-1}$ such that $\mid \sum_{j \in J} A_{ij} -
\sum_{j \in J_{-1}} A_{ij} \mid = {0, -1, +1}$, i.e., result vector with
entries equals to $0, +1 and -1$ $\forall i \in \{1, \dots, m\}$.

\subparagraph{Proof:}
\begin{itemize}
\item "$A$ is TU $\rightarrow$ ..."
\subitem Let $J \subseteq \{1, \dots, n\}$. Define $d \in \{0,1\}^n$, $d_j = 1
\forall j \in J$, $d_i = 0 \forall i \notin J$.\\
$f \in \R^n$, $\lfloor f\rfloor =
\begin{pmatrix}
\lfloor f_1 \rfloor\\
\dots \\
\lfloor f_n \rfloor
\end{pmatrix}$,
$\lceil f\rceil =
\begin{pmatrix}
\lceil f_1 \rceil\\
\dots \\
\lceil f_n \rceil
\end{pmatrix}$.\\
$P = \{ x \in \R^n \mid 0 \leq x \leq d, \lfloor \frac{1}{2} Ad \rfloor \leq Ax
\leq \lceil \frac{1}{2}Ad \rceil \}$, $\frac{d}{2} \in \mathcal{P} \rightarrow
P \neq \emptyset$, $\mathcal{P}$ is bounded $\rightarrow \mathcal{P}$ has
integral extreme point $x \in \{0,1\}^n$ ($0 \leq x \leq d$).\\
Consider $y = d - 2x$, $y_i = 0 \forall i \notin J \rightarrow d = 0$, and
$x$ is also $0$. $y_j \in \{-1, +1 \} \forall j \in J$.\\
Show: $Ay \in \{-1, 0, 1\}$.
\begin{itemize}
\item Suppose $(Ad)_i = 2k \rightarrow (Ay)_i = 0$
\item Suppose $(Ad)_i = 2k + 1 \rightarrow$ then in $\mathcal{P}$: $k \leq
(Ax)_i \leq k+1$.
\end{itemize}
$(Ay)_i = (Ad)_i - 2(Ax)_i = 2k + 1 - 2
\left\{
  \begin{array}{ll}
    k & \text{if } (Ax)_i = k \\
    k+1 & \text{if } (Ax)_i = k+1 \\
  \end{array}
\right.$
Define $J_1 = \{j \in J: y_j = 1\}$, $J_2 = \{ j \in J, y_j = -1\}$,
$J_1 \cap J_2 = \emptyset$,
$J_1 \cup J_2 = J$ and
$\abs{(Ay)_i} =
\abs{\sum_{j \in J_1}
A_{ij} - \sum_{j \in J_2} A_{ij}} \leq 1$ $\forall i = 1, \dots, m$.
\item Conversely:
\subitem Let $B$ be a $k \times k$ nonsingular square submatrix of $A$, $r = 
det[B]$. Goal: $\abs{r} = 1$.\\
Induction on $k$:
\begin{itemize}
\item $k = 1$: trivial, "partition property".
\item $k > 1$:
\subitem $A_{ij} \in \{-1,0, +1\}$, $B_{ij} \in \{-1, 0, 1\}$. $(B^{-1})_{ij}
= \frac{det[B^{ij}]}{r}$. $B^{ij}_{\cdot l} = B_{\cdot l} \forall l \in
\{ 1, \dots, m \} \setminus \{i\}$.
$B^{ij}_{\cdot i} = e_j$.\\
From our hypothesis of induction using the fact $B^{ij}_{\cdot i} = e_j$,
$det[B^{ij}] \in \{0, \pm 1\}$. Let $\bar{A}$ be the matrix with entries
$det[B^{ij}]$.\\
$B^{-1} = \frac{\bar{A}}{r}$, $\bar{A_{ij}} \in \{-1, 0, 1\}$.\\
$B \times \bar{A_{\cdot 1}} = r \times e_1$ (*)\\
Let $J = \{i: \bar{A_{i1}} \neq 0 \}$,
$J'_{1} = \{i \in J, \bar{A_{i1}} = 1\}$.
$B \times \bar{A_{\cdot 1}} = \sum_{j \in J'} b_{ij} - \sum_{j \in J\setminus
\{J'_1\}} b_{ij} = 0$ $ \forall i = 2, \dots, k \} \rightarrow \abs{\{j \in J
\mid b_{ij} \neq 0\}}$ is even. $\rightarrow \forall (J_1, J_2)$ a partition of
$J$ such that $\abs{\underbrace{\sum_{j \in J_1} b_{ij} - \sum_{j \in J_2}
b_{ij}}_{=0 \forall i \in \{2, \dots, k\}}} \leq 1$ $\forall i \in \{2, \dots,
k\}$.\\
From assumptions, there exists such a partition of $J$ into $J_1$ and $J_2$
such that: $\abs{\sum_{j \in J_1} b_{ij} - \sum_{j \in J_2} b_{ij}} = 0,
\forall i = 2, \dots, k$, $\abs{\sum_{j \in J_1} b_{ij} - \sum_{j \in J_2}
b_{ij}} \leq 1$\\
$\rightarrow \exists z \in \{0, \pm 1\}^k$ such that $B_z = \lambda e_1$, where 
$\lambda \in \{+1, -1\}$.\\
From (*): $B\bar{A_{\cdot 1}} = r e_1 \rightarrow \underbrace{\bar{A_{\cdot
1}}}_{\in \{-1, 0, +1\}^k} = \frac{r}{\lambda} \underbrace{z}_{\in
\{-1, 0, 1\}^k} \rightarrow \abs{r} = 1$.
\end{itemize}
\end{itemize}

\todo[inline]{supplementary: sections 19.1 and 19.2 from [sch86]}

\end{document}
