\documentclass[main]{subfiles}
\begin{document}

%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
% Main Topics: linear programming duality, complementary slackness 
% Duality theorem for linear programing - 09.10.2017
% author: Vanessa Leite

\section{Linear Programming Duality}

\textbf{Theorem (Neuman '47): Let $P = \{x \in \mathbb{R}^n \mid Ax \leq b \}
\neq \emptyset$. Assume there exists a point in the polyhedron. $D = \{ y \in
\mathbb{R}^m \mid y \geq 0$, $y^TA = c^T\} \neq \emptyset$.
\emph{$\displaystyle \max_{x \in \mathcal{P}} c^{T}x = \min_{y \in D} y^T b$ }}

\subparagraph{Proof:}
$D$ is a polyhedron in standard form, $D \neq \emptyset$, so, there is no
line, then, $D$ has an extreme point. \\
Since $\mathcal{P} \neq \emptyset$, take any $x \in \mathcal{P}$.
$c^T x \underbrace{=}_{\forall y \in \mathcal{D}} \underbrace{y^T}_{\geq 0}
\underbrace{Ax}_{\leq b} \leq y^T b$, therefore, the minimum is not infinity.
$\exists y^* \in \mathcal{D}$, extreme point such that
$\underbrace{\delta^*}_{\text{optimal value}} = y^{*^T} b = min\{y^T b \mid y
\in \mathcal{D}\}$\\
$\forall x \in \mathcal{P}$, then $c^T x = y^{*^T}Ax \leq \delta^* \rightarrow
\displaystyle \max_{x \in \mathcal{P}} c^{T}x$ is bounded (can not go to
$+\infty$).\\

This way, 
\begin{equation}
\displaystyle \max_{x \in \mathcal{P}} c^{T}x \leq \displaystyle \min_{y \in 
\mathcal{D}} y^{T}b
\end{equation}

Now, consider all points in $\mathcal{P}$ such that $c^T x \geq \delta^*$.
This set must be non empty, because for some $x$, $c^T x = \delta^*$.\\
$\{x \in\mathcal{P} \mid c^T x \geq \delta^* \} \neq \emptyset$. Suppose
it is empty, then:\\
$Ax \leq b$ has no solution and $-c^T x \leq -\delta^*$ (multiplied by $-1$,
so, every inequality is organized in the same way).

By Farka's Lemma, there exists multipliers $z \in \mathbb{R}_{+}^{m}$ and
$\lambda \in \mathbb{R}_{+}$ ($z$ is a multiplier for the first inequality and 
$\lambda$ for the second).

\begin{equation}
\begin{pmatrix}
    z \\
    \lambda
\end{pmatrix}
\begin{pmatrix}
    A \\
    -c^T x
\end{pmatrix}
= 0
\end{equation}

and
\begin{equation}
\begin{pmatrix}
    z \\
    \lambda
\end{pmatrix}
\begin{pmatrix}
    b \\
    -\delta^*
\end{pmatrix}
< 0
\end{equation}

so, $z^T A - \lambda c^T = 0$, $z^T b -\lambda \delta^* < 0$.\\
Assume $\lambda = 0$:\\
By Farka's Lemma, $\exists$ solution $z \geq 0$ such that $z^T A = 0$ and
$z^T b < 0 \iff \mathcal{P} = \emptyset$.
This is a contradiction by definition.\\
Assume $\lambda > 0$:\\
Since $\lambda > 0$ we can divide the system by $\lambda$, this way define
$\bar{y} = \frac{z}{\lambda}$. Then, $z^T A = \lambda c^T \iff
\bar{y}^T A = c^T$, $z^T b < \lambda \delta^* \iff \bar{y}^T b < \delta^*$.\\
$\delta^*$ is $\displaystyle \min_{y \in \mathcal{D}} y^{T}b$, so it is a
contradiction $y^T b < \delta^* \rightarrow \{ x \in \mathcal{P} \mid c^T x 
\geq \delta^*\} \neq \emptyset$, otherwise we would have found another
point better than the minimum.

This way, $\exists x \in \mathcal{P}$ such that $c^Tx \geq \delta^*$.
Since $\forall x \in \mathcal{P}$, $c^Tx \leq \delta^*$, we can conclude that
$c^T x = \delta^*$, thus,

\begin{equation}
\displaystyle \max_{x \in \mathcal{P}} c^{T}x = \displaystyle \min_{y \in 
\mathcal{D}} y^{T}b
\end{equation}

\subsection{Weak complementary slackness}
\textbf{Theorem: $\mathcal{P} = \{x \in \mathbb{R}^n \mid Ax \leq b \} \neq
\emptyset$ and $\mathcal{D} = \{ y \geq 0 \mid y^T A = c^T \} \neq \emptyset$.
We say $x \in \mathcal{P}$ and $y \in \mathcal{D}$ are simultaneously optimal
solutions iff $y_i (A_{i\cdot}x - b_i) = 0$ $\forall i = 1, \dots, m$. }

\subparagraph{Proof:}
\begin{equation} \label{eq:proof-weak-slackness}
c^T x = y^T Ax = \sum_{i=1}^{m} y_i A_{i\cdot} x = \sum_{i: y_i > 0} y_i A_{i
\cdot} x \leq \sum_{i: y_i > 0} y_i b_i = y^T b
\end{equation}

$x \in \mathcal{P}, y \in \mathcal{D}$ are simultaneously optimal 
$\underbrace{\text{iff}}_{duality} c^T x = y^T b \iff \forall i: y_i > 0$, then
$A_i x = b_i \iff y_i(A_{i\cdot}x - b_i) = 0$.

\textbf{Observation: What happens when $\mathcal{P}$ or $\mathcal{D}$ are
empty?}

\paragraph{Lemma: assume $\mathcal{P}$ is non empty, but the dual $\mathcal{D}$
is empty.}
$\mathcal{P} = \{ x \in \mathbb{R}^n \mid Ax \leq b \} \neq \emptyset$,
$D = \{y \in \mathbb{R}^m_+ \mid \underbrace{y^T A = c^T}_{= A^T y = c, y \geq
0} \} =  \emptyset$. Then $\displaystyle \max_{x \in \mathcal{P}} c^{T}
x = +\infty$.

\subparagraph{Proof:}
$\mathcal{P} \neq \emptyset \rightarrow \exists \bar{x} \in \mathcal{P}$.
$\mathcal{D} = \emptyset \underbrace{\rightarrow}_{\text{farka's lemma}}
\exists z$ such that $Az \geq 0, c^T z \leq 0$. \\

\textbf{Claim:} $\bar{x} - \lambda z \in \mathcal{P}, \forall \lambda \geq 0$\\
$A(\bar{x} - \lambda z) = A\bar{x} - \lambda \underbrace{Az}_{\geq 0} \leq b$\\
$c^T(\bar{x} - \lambda z) = c^T \bar{x} - \lambda c^T z \xrightarrow[x \to
\infty]{} +\infty$.

\paragraph{Lemma: assume $\mathcal{D}$ is non empty, but the primal
$\mathcal{P}$ is empty.}
$\mathcal{D} = \{y \in \mathbb{R}^m_+ \mid y^T A = c^T \} \neq \emptyset$,
$\mathcal{P} = \{x \in \mathbb{R}^n \mid Ax \leq b \} = \emptyset$. Then
$\displaystyle \min_{y \in \mathcal{D}} y^{T} b = -\infty$.

\subparagraph{Proof:}
$\mathcal{D} \neq \emptyset \rightarrow \exists \bar{y} \in \mathcal{D}$.
$\mathcal{P} = \emptyset \underbrace{\rightarrow}_{\text{farka's lemma}} 
\exists y: y^T A = 0, y^T b < 0 \rightarrow y < 0$.

\textbf{Claim:} $\bar{y} + \underbrace{\lambda y}_{\text{you can scale
infinitely}} \in \mathcal{D}$, $\forall \lambda \geq 0$ and the sequence of
points $b^T [\bar{y} + \lambda y] \xrightarrow[\lambda \to \infty]{} -\infty$.


\subsection{A short summary}

\begin{center}
 \begin{tabular}{||c c c||} 
 \hline
 & $\mathcal{P} = \emptyset$ & $\mathcal{P} \neq \emptyset$ \\ [0.5ex] 
 \hline\hline
 $\mathcal{D} = \emptyset$ & Both are infeasible &  $\displaystyle \max_{x \in 
 \mathcal{P}} c^{T} x = +\infty$ \\ 
 \hline
 $\mathcal{D} \neq \emptyset$ & $\displaystyle \min_{y \in \mathcal{D}} y^{T}
 b = -\infty$ & $\displaystyle \max_{x \in \mathcal{P}} c^{T} x =
 \displaystyle \min_{y \in \mathcal{D}} y^{T} b$ \\
 \hline
\end{tabular}
\end{center}

\subsection{Dualization operator}
If we agree on a linear optimization of the following form: $\displaystyle 
\max_{Ax \leq b} c^{T} x$, we can create a "dualization" operator.\\

$ Dual(\displaystyle \max_{x \in \mathcal{P}} c^{T} x) = \displaystyle
\min_{y^T A = c^T, y \geq 0} y^{T} b$\\

\textbf{Observation:} The dual of the dual linear programming is the primal, 
provided all are non empty.\\

By applying the dual, we first "drop" the sign on the objective function:\\
 $\displaystyle \min_{y \in \mathcal{D}} y^{T} b =
 \displaystyle \max -y^{T}b$,  $A^T y \leq c$, $-A^T y \leq -c$, $-Iy \leq 0$
 \\
 
$ Dual(\displaystyle \max (-b)^{T} y)$, $A^T y \leq c$, $-A^T y \leq -c$, $-Iy
\leq 0) =  \displaystyle \min -c^{T}\underbrace{(v - u)}_{=z}$, $A(v-u)+w = b$, 
$u, v, w \geq 0 = \displaystyle \min -c^T z$, $Az + w =b$, $w \geq 0$\\

Then, we "reapply" the sign on the objective function 
$\displaystyle \min -c^{T} z$, $Az \leq b = \displaystyle \max c^{T} z$, $Az
\leq b$

\subsection{Supplementary Reading - Section 4.3 from [BT97]}
\todo[inline]{update}


\end{document}